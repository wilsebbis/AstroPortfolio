---
import Section from "./Section.astro";

const phrasedProjects = [
    {
        project: "an LLM",
        purpose: "cooking",
        progress: "helped 10,000 people become better home chefs",
        projectColor: "text-accent-primary",
        purposeColor: "text-accent-secondary",
        progressColor: "text-accent-tertiary",
    },
    {
        project: "a data pipeline",
        purpose: "family connections",
        progress: "reconnected 5,000 families across the globe",
        projectColor: "text-accent-secondary",
        purposeColor: "text-accent-tertiary",
        progressColor: "text-accent-primary",
    },
    {
        project: "a deployment engine",
        purpose: "edge devices",
        progress: "shipped 50+ models to production",
        projectColor: "text-accent-tertiary",
        purposeColor: "text-accent-primary",
        progressColor: "text-accent-secondary",
    },
    {
        project: "a training platform",
        purpose: "model iteration",
        progress: "reduced training time by 10x",
        projectColor: "text-accent-primary",
        purposeColor: "text-accent-tertiary",
        progressColor: "text-accent-secondary",
    },
];
---

<Section
    id="what-i-build"
    class="py-32 md:py-48 min-h-[90vh] flex flex-col items-center justify-center overflow-hidden"
>
    <div class="max-w-6xl mx-auto px-8 w-full">
        <!-- Dynamic Headline -->
        <div class="text-center mb-24">
            <h2
                class="font-display text-3xl md:text-5xl font-bold tracking-tight leading-[1.3] mb-4"
            >
                I built
                <span
                    id="dynamic-project"
                    class="inline-block transition-all duration-500 opacity-0 translate-y-4"
                ></span>
                for
                <span
                    id="dynamic-purpose"
                    class="inline-block transition-all duration-500 opacity-0 translate-y-4"
                ></span>
                that
                <span
                    id="dynamic-progress"
                    class="inline-block transition-all duration-500 opacity-0 translate-y-4"
                ></span>
            </h2>
        </div>

        <!-- Capability Cards -->
    </div>
</Section>

<script>
    const projects = [
        {
            project: "a data pipeline",
            purpose: "family connections",
            progress: "reconnected 5,000 families across the globe",
            projectClass: "text-accent-secondary",
            purposeClass: "text-accent-tertiary",
            progressClass: "text-accent-primary",
        },
        {
            project: "an LLM",
            purpose: "cooking",
            progress: "helped 10,000 people become better home chefs",
            projectClass: "text-accent-primary",
            purposeClass: "text-accent-secondary",
            progressClass: "text-accent-tertiary",
        },
        {
            project: "a deployment engine",
            purpose: "edge devices",
            progress: "shipped 50+ models to production",
            projectClass: "text-accent-tertiary",
            purposeClass: "text-accent-primary",
            progressClass: "text-accent-secondary",
        },
        {
            project: "a training platform",
            purpose: "model iteration",
            progress: "reduced training time by 10x",
            projectClass: "text-accent-primary",
            purposeClass: "text-accent-tertiary",
            progressClass: "text-accent-secondary",
        },
    ];

    let currentIndex = 0;
    const projectEl = document.getElementById("dynamic-project");
    const purposeEl = document.getElementById("dynamic-purpose");
    const progressEl = document.getElementById("dynamic-progress");

    function updatePhrasing() {
        if (!projectEl || !purposeEl || !progressEl) return;

        const {
            project,
            purpose,
            progress,
            projectClass,
            purposeClass,
            progressClass,
        } = projects[currentIndex];

        // Animate out
        projectEl.classList.add("opacity-0", "translate-y-[-1rem]");
        purposeEl.classList.add("opacity-0", "translate-y-[-1rem]");
        progressEl.classList.add("opacity-0", "translate-y-[-1rem]");

        setTimeout(() => {
            // Update content and colors
            projectEl.textContent = project;
            purposeEl.textContent = purpose;
            progressEl.textContent = progress;

            // Clear previous classes
            projectEl.className =
                "inline-block transition-all duration-500 opacity-0 translate-y-4";
            purposeEl.className =
                "inline-block transition-all duration-500 opacity-0 translate-y-4";
            progressEl.className =
                "inline-block transition-all duration-500 opacity-0 translate-y-4";

            // Add new classes
            projectEl.classList.add(projectClass);
            purposeEl.classList.add(purposeClass);
            progressEl.classList.add(progressClass);

            // Trigger reflow
            projectEl.offsetHeight;
            purposeEl.offsetHeight;
            progressEl.offsetHeight;

            // Animate in
            projectEl.classList.remove("opacity-0", "translate-y-4");
            purposeEl.classList.remove("opacity-0", "translate-y-4");
            progressEl.classList.remove("opacity-0", "translate-y-4");

            currentIndex = (currentIndex + 1) % projects.length;
        }, 500);
    }

    // Initial run
    updatePhrasing();

    // Interval
    if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
        setInterval(updatePhrasing, 4000);
    }
</script>
